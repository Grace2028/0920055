<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ç´…è±†é¤…è£½é€ æµç¨‹ â€” ç°¡æ˜“ç¤ºç¯„é </title>
  <style>
    :root{
      --bg:#fff7f5;
      --panel:#fff1ef;
      --accent:#ff6b6b;
      --muted:#6b6b6b;
      --belt:#5c4033;
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans TC',sans-serif}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#ffecec);color:#2b2b2b;padding:24px}
    .container{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px}
    header h1{margin:0;font-size:20px}
    .controls{margin-left:auto;display:flex;gap:8px;align-items:center}
    button{background:var(--accent);border:none;color:white;padding:8px 12px;border-radius:10px;cursor:pointer}
    button.secondary{background:transparent;color:var(--accent);border:2px solid var(--accent)}

    /* è£½ç¨‹é¢æ¿ */
    .panel{background:var(--panel);padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.06);margin-top:18px}
    .stage-row{display:flex;gap:12px;align-items:flex-start}
    .stage{flex:1;padding:12px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.6),transparent);min-height:120px}
    .stage h3{margin:0 0 8px 0;font-size:14px}
    .icon{font-size:28px}
    .muted{color:var(--muted);font-size:13px}

    /* å‚³é€å¸¶èˆ‡å‹•ç•«å€ */
    .factory{margin-top:16px;position:relative;height:220px;overflow:hidden;border-radius:12px;background:linear-gradient(180deg,#fff,#fff7f2);border:1px solid rgba(0,0,0,0.04)}
    .belt{position:absolute;left:0;right:0;bottom:20px;height:60px;background:repeating-linear-gradient(90deg,var(--belt) 0 40px, #7b5a48 40px 80px);transform:skewY(-3deg)}
    .tray{position:absolute;left:-120px;bottom:80px;width:110px;height:60px;border-radius:8px;background:#f6d7d7;display:flex;align-items:center;justify-content:center;font-weight:700}
    .cake{width:48px;height:28px;border-radius:6px;background:linear-gradient(180deg,#ffd9d9,#ffb9b9);display:flex;align-items:center;justify-content:center;font-size:12px}

    /* å°‡æ‰˜ç›¤æ²¿å‚³é€å¸¶ç§»å‹• */
    @keyframes moveTray{from{transform:translateX(-140px)}to{transform:translateX(1100px)}}

    /* æ©Ÿæ¢°æ‰‹è‡‚ */
    .arm{position:absolute;left:40px;top:18px;width:160px;height:160px}
    .arm .base{position:absolute;left:40px;bottom:0;width:40px;height:40px;background:#d8d8d8;border-radius:6px}
    .arm .upper{position:absolute;left:60px;top:18px;width:10px;height:80px;background:#bfbfbf;transform-origin:top center;border-radius:6px}
    .arm .lower{position:absolute;left:68px;top:82px;width:10px;height:50px;background:#a9a9a9;transform-origin:top center;border-radius:6px}
    .arm .hand{position:absolute;left:56px;top:128px;width:48px;height:18px;border-radius:6px;background:#6b6b6b;display:flex;align-items:center;justify-content:center;color:white;font-size:12px}

    @keyframes armSwing{0%{transform:rotate(-6deg)}50%{transform:rotate(18deg)}100%{transform:rotate(-6deg)}}

    /* å°å‹•ç•«æ•ˆæœ */
    .sparkle{position:absolute;right:18px;top:18px;font-size:22px;opacity:0;transform:scale(.6);}
    .zoom-controls{display:flex;gap:6px}

    /* èª¿è‰²èˆ‡éŸ¿æ‡‰ */
    .settings{display:flex;gap:12px;align-items:center;margin-top:12px}
    input[type=range]{width:140px}
    @media(max-width:720px){header{flex-direction:column;align-items:flex-start}.controls{margin-left:0}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ç´…è±†é¤…è£½é€ æµç¨‹ â€” ç°¡æ˜“äº’å‹•ç¤ºç¯„</h1>
      <div class="controls">
        <div class="zoom-controls">
          <button id="zoomOut" class="secondary">-</button>
          <button id="zoomIn" class="secondary">+</button>
        </div>
        <button id="start">é–‹å§‹è‡ªå‹•åŒ–</button>
        <button id="stop" class="secondary">åœæ­¢</button>
      </div>
    </header>

    <div class="panel">
      <div class="stage-row">
        <div class="stage">
          <div class="icon">ğŸŒ¾</div>
          <h3>1. éºµç³Šæº–å‚™</h3>
          <div class="muted">æ··åˆéºµç²‰ã€è›‹ã€ç‰›å¥¶ï¼Œèª¿æˆé©ç•¶æ¿ƒåº¦ã€‚</div>
        </div>
        <div class="stage">
          <div class="icon">ğŸ®</div>
          <h3>2. ç´…è±†é¤¡æº–å‚™</h3>
          <div class="muted">ç´…è±†ç…®ç†ŸåŠ ç³–ï¼Œå†·å»æˆé¤¡æ–™ã€‚</div>
        </div>
        <div class="stage">
          <div class="icon">ğŸ¤–</div>
          <h3>3. æˆå‹/è‡ªå‹•å¡«é¤¡</h3>
          <div class="muted">æ©Ÿæ¢°æ‰‹è‡‚å€’å…¥éºµç³Šã€æ”¾å…¥ç´…è±†é¤¡å¾Œå°å£ã€‚</div>
        </div>
        <div class="stage">
          <div class="icon">ğŸ”¥</div>
          <h3>4. çƒ˜çƒ¤/ç…è£½</h3>
          <div class="muted">åœ¨å¹³æ¿æˆ–æ¨¡å…·ä¸Šçƒ˜çƒ¤è‡³é‡‘é»ƒï¼Œæ§æº«å¾ˆé‡è¦ã€‚</div>
        </div>
      </div>

      <div class="settings">
        <label>é€Ÿåº¦ <input id="speed" type="range" min="0.2" max="3" step="0.1" value="1"></label>
        <label>ä¸»è‰² <input id="accentColor" type="color" value="#ff6b6b"></label>
        <label>å‚³é€å¸¶è‰² <input id="beltColor" type="color" value="#5c4033"></label>
        <div class="muted">æç¤ºï¼šèª¿æ•´é€Ÿåº¦æˆ–é¡è‰²å³å¯çœ‹åˆ°å‹•ç•«è®ŠåŒ–ã€‚</div>
      </div>

      <div class="factory" id="factory">
        <div class="arm" id="arm">
          <div class="base"></div>
          <div class="upper"></div>
          <div class="lower"></div>
          <div class="hand">æŠ“å–</div>
        </div>

        <div class="sparkle" id="spark">âœ¨</div>

        <div class="belt" id="belt"></div>

        <!-- å‹•æ…‹æ‰˜ç›¤æ¨¡æ¿ï¼ˆç”± JS è¤‡è£½ï¼‰ -->
        <div class="tray" id="trayTemplate" style="display:none">
          <div class="cake">ç´…è±†</div>
        </div>

      </div>
    </div>

    <footer style="margin-top:12px;font-size:13px;color:var(--muted)">ç°¡å–®æ•™å­¸ç¤ºç¯„ â€” é€™æ˜¯ä¸€å€‹å–®é å‹•ç•«åŸå‹ï¼Œç”¨æ–¼èªªæ˜è‡ªå‹•åŒ–è£½ä½œç´…è±†é¤…çš„æµç¨‹ã€‚</footer>
  </div>

  <script>
    const startBtn = document.getElementById('start');
    const stopBtn = document.getElementById('stop');
    const speedRange = document.getElementById('speed');
    const accentPicker = document.getElementById('accentColor');
    const beltPicker = document.getElementById('beltColor');
    const trayTemplate = document.getElementById('trayTemplate');
    const factory = document.getElementById('factory');
    const arm = document.getElementById('arm');
    const spark = document.getElementById('spark');
    const belt = document.getElementById('belt');
    const zoomIn = document.getElementById('zoomIn');
    const zoomOut = document.getElementById('zoomOut');

    let running = false;
    let trayInterval = null;

    function setTheme(){
      document.documentElement.style.setProperty('--accent', accentPicker.value);
      document.documentElement.style.setProperty('--belt', beltPicker.value);
    }

    accentPicker.addEventListener('input', setTheme);
    beltPicker.addEventListener('input', setTheme);

    function spawnTray(){
      const tray = trayTemplate.cloneNode(true);
      tray.style.display = 'flex';
      tray.id = '';
      tray.style.left = '-140px';
      tray.style.bottom = '80px';
      tray.style.position = 'absolute';
      tray.style.animation = `moveTray ${3/speedRange.value}s linear forwards`;
      factory.appendChild(tray);

      // ç•¶æ‰˜ç›¤èµ°åˆ°ä¸­é–“ï¼Œæ¨¡æ“¬æ©Ÿæ¢°æ‰‹æŠ“å–ï¼ˆtrigger sparkleï¼‰
      setTimeout(()=>{
        spark.style.transition='opacity .3s,transform .3s';
        spark.style.opacity=1; spark.style.transform='scale(1)';
        setTimeout(()=>{spark.style.opacity=0; spark.style.transform='scale(.6)'},300);
      }, (1500/speedRange.value));

      // ç§»é™¤æ‰˜ç›¤ä»¥å…å †ç©
      tray.addEventListener('animationend',()=> tray.remove());
    }

    function startProcess(){
      if(running) return;
      running = true;
      arm.style.animation = `armSwing ${1.2/speedRange.value}s ease-in-out infinite`;
      belt.style.animation = `scrollBelt ${1.8/speedRange.value}s linear infinite`;
      spawnTray();
      trayInterval = setInterval(spawnTray, 1400/speedRange.value);
    }

    function stopProcess(){
      running = false;
      arm.style.animation = '';
      belt.style.animation = '';
      if(trayInterval) clearInterval(trayInterval);
      trayInterval = null;
    }

    startBtn.onclick = startProcess;
    stopBtn.onclick = stopProcess;

    speedRange.addEventListener('input', ()=>{
      if(running){
        // é‡å•Ÿä»¥æ‡‰ç”¨æ–°é€Ÿåº¦
        stopProcess(); startProcess();
      }
    });

    // Belt pseudo-animation using background-position via CSS animation inserted dynamically
    const styleSheet = document.createElement('style');
    styleSheet.innerHTML = `@keyframes scrollBelt{from{background-position:0 0}to{background-position:160px 0}}`;
    document.head.appendChild(styleSheet);

    // Zoom controls
    let scale = 1;
    zoomIn.addEventListener('click', ()=>{scale = Math.min(1.6, scale+0.1); factory.style.transform = `scale(${scale})`;});
    zoomOut.addEventListener('click', ()=>{scale = Math.max(.7, scale-0.1); factory.style.transform = `scale(${scale})`;});

    // åˆå§‹ä¸»é¡Œ
    setTheme();

    // Shortcut: auto-start for demo
    // startProcess();
  </script>
</body>
</html>
